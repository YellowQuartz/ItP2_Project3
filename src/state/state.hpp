#ifndef __STATE_H__
#define __STATE_H__

#include <string>
#include <cstdlib>
#include <vector>
#include <map>
#include <utility>

#include "../config.hpp"

enum Player {
    WHITE = 1,
    BLACK = -1
};

enum Piece {
    pawn = 1,
    white_pawn = 2,
    black_pawn = 0,
    rook = 4,
    white_rook = 5,
    black_rook = 3,
    knight = 7,
    white_knight = 8,
    black_knight = 6,
    bishop = 10,
    white_bishop = 11,
    black_bishop = 9,
    queen = 13,
    white_queen = 14,
    black_queen = 12,
    king = 16,
    white_king = 17,
    black_king = 15
};

const int initial_board[12] = { 992, 32505856, 16, 33554432, 8, 67108864, 4, 134217728, 2, 268435456, 1, 536870912 };

const int universe = 1073741823;
const int queenZone = 1040187423;
const int columns[5] = { 554189328, 277094664, 138547332, 69273666, 34636833 };
const int rows[6] = { 1040187392, 32505856, 1015808, 31744, 992, 31 };

const int cap = 1073741824;

const int BishopMagic[30] = { 545309696, 155222592, 277938180, 270794760, 404788224,
                       135186, 600104, 9633856, 73808, 6326020,
                       4479104, 1312833, 34609168, 1050881, 5251713,
                       144982080, 2424872, 8457248, 304218321, 139527200,
                       35754008, 67704864, 1058121, 8718338, 2245665,
                       67648, 2107472, 5900576, 5253184, 4326466 };

const int RookMagic[30] = { 17039872, 34086944, 33845280, 16843296, 16793632,
                     532496, 266304, 9446529, 499138822, 1049602,
                     540929, 4350016, 20989968, 2130980, 1082370,
                     16812096, 29425920, 138478098, 539001868, 136448001,
                     273760288, 1836128, 27283472, 532868, 201853968,
                     9486347, 1065729, 4199433, 69243138, 164490 };

const int BishopBlockerMask[30] = { 266304, 8320, 320, 2176, 69888,
                              8521728, 266240, 10240, 69632, 2236416,
                              4259904, 8519808, 328000, 2228352, 4456704,
                              2099328, 4198656, 10496000, 4198464, 8396928,
                              69888, 139264, 327680, 133120, 266304,
                              2236416, 4456448, 10485760, 4259840, 8521728 };

const int RookBlockerMask[30] = { 1082414, 2164812, 4329610, 8659206, 17318414,
                            1082816, 2165120, 4329792, 8659136, 17318336,
                            1095712, 2175040, 4335744, 8657152, 17316352,
                            1508384, 2492480, 4526208, 8593664, 17252864,
                            14713888, 12650560, 10621056, 6562048, 15221248,
                            470844448, 404817984, 339873920, 209985792, 487080448 };

const int BishopLookupTable[64][16] = { { 17043520, 4160, 266304, 4160, 64, 64, 64, 64, 0, 0, 0, 0, 0, 0, 0, 0 }, { 532640, 8352, 160, 160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 17728, 1344, 16704, 320, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 35456, 640, 2688, 640, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 1118464, 4352, 69888, 4352, 256, 256, 256, 256, 0, 0, 0, 0, 0, 0, 0, 0 }, { 545392642, 8521730, 2050, 2050, 133122, 133122, 2050, 2050, 0, 0, 0, 0, 0, 0, 0, 0 }, { 17044485, 5125, 267269, 5125, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 567306, 534538, 43018, 10250, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 1134612, 20500, 86036, 20500, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 35790856, 139272, 8200, 8200, 2236424, 139272, 8200, 8200, 0, 0, 0, 0, 0, 0, 0, 0 }, { 272695364, 65600, 272695360, 65604, 4259908, 65600, 4259904, 65604, 0, 0, 0, 0, 0, 0, 0, 0 }, { 545423528, 545423520, 164008, 164000, 8552616, 8552608, 164008, 164000, 0, 0, 0, 0, 0, 0, 0, 0 }, { 18153809, 18153808, 328001, 328000, 18153793, 18153792, 17105233, 17105232, 1376593, 1376592, 17105217, 17105216, 1376577, 1376576, 328017, 328016 }, { 36307586, 36307584, 656002, 656000, 2753154, 2753152, 656002, 656000, 0, 0, 0, 0, 0, 0, 0, 0 }, { 71565572, 262404, 71565568, 262400, 4456708, 262404, 4456704, 262400, 0, 0, 0, 0, 0, 0, 0, 0 }, { 136317064, 2099336, 136317056, 2099328, 136316928, 2099200, 136316928, 2099200, 0, 0, 0, 0, 0, 0, 0, 0 }, { 273683728, 5248272, 273683456, 5248000, 273683712, 5248256, 273683456, 5248000, 0, 0, 0, 0, 0, 0, 0, 0 }, { 580921888, 547367456, 580921856, 547367424, 44050976, 10496544, 44050944, 10496512, 580921376, 547366944, 580921344, 547366912, 44050464, 10496032, 44050432, 10496000 }, { 88100929, 88100928, 20992000, 20992000, 88100864, 88100864, 20992065, 20992064, 0, 0, 0, 0, 0, 0, 0, 0 }, { 142614658, 142614528, 8396930, 8396800, 142614528, 142614656, 8396800, 8396928, 0, 0, 0, 0, 0, 0, 0, 0 }, { 67178768, 67174400, 67174400, 67178496, 67178752, 67174400, 67174400, 67178496, 0, 0, 0, 0, 0, 0, 0, 0 }, { 167944704, 167936000, 167944192, 167936000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 335889408, 335873024, 335888384, 335872000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 671746080, 671744000, 671746048, 671744000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 268701761, 268701760, 268697600, 268697600, 268701696, 268701696, 268697600, 268697600, 0, 0, 0, 0, 0, 0, 0, 0 }, { 2236928, 2097152, 2228224, 2097152, 2236416, 2097152, 2228224, 2097152, 0, 0, 0, 0, 0, 0, 0, 0 }, { 5521408, 5242880, 5505024, 5242880, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 11042816, 10518528, 11010048, 10485760, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 21038080, 20971520, 21037056, 20971520, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 8521760, 8519680, 8521728, 8519680, 8388608, 8388608, 8388608, 8388608, 0, 0, 0, 0, 0, 0, 0, 0 } };
const int RookLookupTable[64][128] = { { 34636862, 62, 33854, 62, 34636834, 34, 33826, 34, 34636838, 38, 33830, 38, 34636834, 34, 33826, 34, 34636846, 46, 33838, 46, 34636834, 34, 33826, 34, 34636838, 38, 33830, 38, 34636834, 34, 33826, 34, 1086, 62, 1086, 62, 1058, 34, 1058, 34, 1062, 38, 1062, 38, 1058, 34, 1058, 34, 1070, 46, 1070, 46, 1058, 34, 1058, 34, 1062, 38, 1062, 38, 1058, 34, 1058, 34, 1082430, 62, 33854, 62, 1082402, 34, 33826, 34, 1082406, 38, 33830, 38, 1082402, 34, 33826, 34, 1082414, 46, 33838, 46, 1082402, 34, 33826, 34, 1082406, 38, 33830, 38, 1082402, 34, 33826, 34, 1086, 62, 1086, 62, 1058, 34, 1058, 34, 1062, 38, 1062, 38, 1058, 34, 1058, 34, 1070, 46, 1070, 46, 1058, 34, 1058, 34, 1062, 38, 1062, 38, 1058, 34, 1058, 34 }, { 69273693, 2141, 93, 93, 2164829, 2141, 93, 93, 69273669, 2117, 69, 69, 2164805, 2117, 69, 69, 69273677, 2125, 77, 77, 2164813, 2125, 77, 77, 69273669, 2117, 69, 69, 2164805, 2117, 69, 69, 67677, 2141, 93, 93, 67677, 2141, 93, 93, 67653, 2117, 69, 69, 67653, 2117, 69, 69, 67661, 2125, 77, 77, 67661, 2125, 77, 77, 67653, 2117, 69, 69, 67653, 2117, 69, 69, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 138547355, 139, 155, 4234, 138547354, 138, 154, 4251, 4329627, 155, 155, 4250, 4329626, 154, 154, 4251, 138547339, 155, 139, 4250, 138547338, 154, 138, 4235, 4329611, 139, 139, 4234, 4329610, 138, 138, 4235, 135323, 139, 155, 4234, 135322, 138, 154, 4251, 135323, 155, 155, 4250, 135322, 154, 154, 4251, 135307, 155, 139, 4250, 135306, 154, 138, 4235, 135307, 139, 139, 4234, 135306, 138, 138, 4235, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 277094679, 279, 277094678, 278, 277094676, 276, 277094676, 276, 270615, 279, 270614, 278, 270612, 276, 270612, 276, 8659223, 279, 8659222, 278, 8659220, 276, 8659220, 276, 270615, 279, 270614, 278, 270612, 276, 270612, 276, 8471, 279, 8470, 278, 8468, 276, 8468, 276, 8471, 279, 8470, 278, 8468, 276, 8468, 276, 8471, 279, 8470, 278, 8468, 276, 8468, 276, 8471, 279, 8470, 278, 8468, 276, 8468, 276, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 554189327, 527, 541199, 527, 554189326, 526, 541198, 526, 554189324, 524, 541196, 524, 554189324, 524, 541196, 524, 554189320, 520, 541192, 520, 554189320, 520, 541192, 520, 554189320, 520, 541192, 520, 554189320, 520, 541192, 520, 16911, 527, 16911, 527, 16910, 526, 16910, 526, 16908, 524, 16908, 524, 16908, 524, 16908, 524, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 17318415, 527, 541199, 527, 17318414, 526, 541198, 526, 17318412, 524, 541196, 524, 17318412, 524, 541196, 524, 17318408, 520, 541192, 520, 17318408, 520, 541192, 520, 17318408, 520, 541192, 520, 17318408, 520, 541192, 520, 16911, 527, 16911, 527, 16910, 526, 16910, 526, 16908, 524, 16908, 524, 16908, 524, 16908, 524, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 16904, 520, 16904, 520 }, { 34637761, 1083329, 34636865, 1082433, 34636993, 1082561, 34636865, 1082433, 34637249, 1082817, 34636865, 1082433, 34636993, 1082561, 34636865, 1082433, 34753, 34753, 33857, 33857, 33985, 33985, 33857, 33857, 34241, 34241, 33857, 33857, 33985, 33985, 33857, 33857, 1985, 1985, 1089, 1089, 1217, 1217, 1089, 1089, 1473, 1473, 1089, 1089, 1217, 1217, 1089, 1089, 1985, 1985, 1089, 1089, 1217, 1217, 1089, 1089, 1473, 1473, 1089, 1089, 1217, 1217, 1089, 1089, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 69274530, 69273762, 69274018, 69273762, 2165666, 2164898, 2165154, 2164898, 68514, 67746, 68002, 67746, 68514, 67746, 68002, 67746, 2978, 2210, 2466, 2210, 2978, 2210, 2466, 2210, 2978, 2210, 2466, 2210, 2978, 2210, 2466, 2210, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 138548068, 4964, 4330308, 4932, 136036, 4964, 136004, 4932, 138547556, 4452, 4329796, 4420, 135524, 4452, 135492, 4420, 4330340, 4964, 138548036, 4932, 136036, 4964, 136004, 4932, 4329828, 4452, 138547524, 4420, 135524, 4452, 135492, 4420, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 277095144, 8659688, 271080, 271080, 8936, 8936, 8936, 8936, 277095048, 8659592, 270984, 270984, 8840, 8840, 8840, 8840, 277095048, 8659592, 270984, 270984, 8840, 8840, 8840, 8840, 277095112, 8659656, 271048, 271048, 8904, 8904, 8904, 8904, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 554189296, 16880, 17318384, 16880, 554189264, 16848, 17318352, 16848, 554189200, 16784, 17318288, 16784, 554189200, 16784, 17318288, 16784, 554189072, 16656, 17318160, 16656, 554189072, 16656, 17318160, 16656, 554189072, 16656, 17318160, 16656, 554189072, 16656, 17318160, 16656, 541168, 16880, 541168, 16880, 541136, 16848, 541136, 16848, 541072, 16784, 541072, 16784, 541072, 16784, 541072, 16784, 540944, 16656, 540944, 16656, 540944, 16656, 540944, 16656, 540944, 16656, 540944, 16656, 540944, 16656, 540944, 16656, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 34666529, 34666528, 34637857, 34637856, 34641953, 34641952, 34637857, 34637856, 34650145, 34650144, 34637857, 34637856, 34641953, 34641952, 34637857, 34637856, 1112097, 1112096, 1083425, 1083424, 1087521, 1087520, 1083425, 1083424, 1095713, 1095712, 1083425, 1083424, 1087521, 1087520, 1083425, 1083424, 63521, 63520, 34849, 34848, 38945, 38944, 34849, 34848, 47137, 47136, 34849, 34848, 38945, 38944, 34849, 34848, 63521, 63520, 34849, 34848, 38945, 38944, 34849, 34848, 47137, 47136, 34849, 34848, 38945, 38944, 34849, 34848, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 69301314, 69276736, 78912, 70722, 2192450, 2167872, 69284930, 70722, 69301312, 70722, 2176066, 70720, 2192448, 70722, 69284928, 70720, 95298, 70720, 2176064, 69276738, 95298, 70720, 78914, 2167874, 95296, 69276738, 78914, 69276736, 95296, 2167874, 78912, 2167872, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 138570884, 138569860, 4353156, 4352132, 138554500, 138553476, 4336772, 4335748, 158852, 157828, 158852, 157828, 142468, 141444, 142468, 141444, 138570880, 138569856, 4353152, 4352128, 138554496, 138553472, 4336768, 4335744, 158848, 157824, 158848, 157824, 142464, 141440, 142464, 141440, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 277110024, 285952, 277109000, 284928, 277106952, 282880, 277106952, 282880, 285960, 8674568, 284936, 8673544, 282888, 8671496, 282888, 8671496, 277110016, 285960, 277108992, 284936, 277106944, 282888, 277106944, 282888, 285952, 8674560, 284928, 8673536, 282880, 8671488, 282880, 8671488, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 554188304, 540160, 17317392, 540160, 554187280, 539136, 17316368, 539136, 554185232, 537088, 17314320, 537088, 554185232, 537088, 17314320, 537088, 554181136, 532992, 17310224, 532992, 554181136, 532992, 17310224, 532992, 554181136, 532992, 17310224, 532992, 554181136, 532992, 17310224, 532992, 540176, 554188288, 540176, 17317376, 539152, 554187264, 539152, 17316352, 537104, 554185216, 537104, 17314304, 537104, 554185216, 537104, 17314304, 533008, 554181120, 533008, 17310208, 533008, 554181120, 533008, 17310208, 533008, 554181120, 533008, 17310208, 533008, 554181120, 533008, 17310208, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 35587105, 35062816, 35587072, 35062784, 2032673, 1508384, 2032640, 1508352, 34669601, 34669600, 34669568, 34669568, 1115169, 1115168, 1115136, 1115136, 34800673, 34800672, 34800640, 34800640, 1246241, 1246240, 1246208, 1246208, 34669601, 34669600, 34669568, 34669568, 1115169, 1115168, 1115136, 1115136, 35587104, 35062817, 35587072, 35062784, 2032672, 1508385, 2032640, 1508352, 34669600, 34669601, 34669568, 34669568, 1115168, 1115169, 1115136, 1115136, 34800672, 34800673, 34800640, 34800640, 1246240, 1246241, 1246208, 1246208, 34669600, 34669601, 34669568, 34669568, 1115168, 1115169, 1115136, 1115136, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 70158402, 69371970, 69634114, 69371970, 70158336, 69371904, 69634048, 69371904, 3049536, 2263104, 2525248, 2263104, 3049472, 2263040, 2525184, 2263040, 3049538, 2263106, 2525250, 2263106, 3049472, 2263040, 2525184, 2263040, 70158400, 69371968, 69634112, 69371968, 70158336, 69371904, 69634048, 69371904, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 139300996, 139268228, 5083268, 5050500, 138776708, 138743940, 4558980, 4526212, 139300864, 139268096, 5083136, 5050368, 138776576, 138743808, 4558848, 4526080, 139300992, 139268224, 5083264, 5050496, 138776704, 138743936, 4558976, 4526208, 139300864, 139268096, 5083136, 5050368, 138776576, 138743808, 4558848, 4526080, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 277586184, 9052160, 277553416, 9150728, 277487880, 9117960, 277487880, 9052424, 277585920, 9052424, 277553152, 9150464, 277487616, 9117696, 277487616, 9052160, 277586176, 9052160, 277553408, 9150720, 277487872, 9117952, 277487872, 9052416, 277585920, 9052416, 277553152, 9150464, 277487616, 9117696, 277487616, 9052160, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 554156560, 17285648, 554156032, 17285120, 554156544, 17285632, 554156032, 17285120, 554123792, 17252880, 554123264, 17252352, 554123776, 17252864, 554123264, 17252352, 554058256, 17187344, 554057728, 17186816, 554058240, 17187328, 554057728, 17186816, 554058256, 17187344, 554057728, 17186816, 554058240, 17187328, 554057728, 17186816, 553927184, 17056272, 553926656, 17055744, 553927168, 17056256, 553926656, 17055744, 553927184, 17056272, 553926656, 17055744, 553927168, 17056256, 553926656, 17055744, 553927184, 17056272, 553926656, 17055744, 553927168, 17056256, 553926656, 17055744, 553927184, 17056272, 553926656, 17055744, 553927168, 17056256, 553926656, 17055744, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 65045537, 35684352, 39878656, 35684352, 35685409, 65045504, 35684352, 39878656, 39879713, 35685376, 65045536, 35684352, 35685409, 39879680, 35685408, 65045504, 48268321, 35685376, 39879712, 35685376, 35685409, 48268288, 35685408, 39879680, 39879713, 35685376, 48268320, 35685376, 35685409, 39879680, 35685408, 48268288, 65044480, 35685376, 39879712, 35685376, 35684352, 65044480, 35685408, 39879680, 39878656, 35684352, 65044480, 35685376, 35684352, 39878656, 35684352, 65044480, 48267264, 35684352, 39878656, 35684352, 35684352, 48267264, 35684352, 39878656, 39878656, 35684352, 48267264, 35684352, 35684352, 39878656, 35684352, 48267264, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 97585218, 72417280, 97583104, 97585216, 72419394, 97583104, 72417280, 72419392, 80807936, 72417280, 80805888, 80807936, 72419394, 80805888, 72417280, 72419392, 97585152, 72417280, 97583104, 97585152, 72419328, 97583104, 72417280, 72419328, 80808002, 72417280, 80805888, 80808000, 72419328, 80805888, 72417280, 72419328, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 162664580, 161616004, 162664448, 161615872, 145887364, 144838788, 145887232, 144838656, 162664576, 161616000, 162664448, 161615872, 145887360, 144838784, 145887232, 144838656, 162660352, 161611776, 162660352, 161611776, 145883136, 144834560, 145883136, 144834560, 162660352, 161611776, 162660352, 161611776, 145883136, 144834560, 145883136, 144834560, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 292823304, 291766272, 292823040, 292814848, 292823296, 292814848, 292823040, 292814848, 289677576, 292814848, 289677312, 289669120, 289677568, 289669120, 289677312, 289669120, 289677576, 289669120, 289677312, 289669120, 289677568, 289669120, 289677312, 289669120, 291774728, 289669120, 291774464, 291766272, 291774720, 291766272, 291774464, 291766272, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 553140752, 545783808, 552092176, 553140224, 549995024, 552091648, 549995024, 549994496, 545800720, 549994496, 545800720, 545800192, 545800720, 545800192, 545800720, 545800192, 553140736, 545800192, 552092160, 553140224, 549995008, 552091648, 549995008, 549994496, 545800704, 549994496, 545800704, 545800192, 545800704, 545800192, 545800704, 545800192, 553123840, 545800192, 552075264, 553123840, 549978112, 552075264, 549978112, 549978112, 545783808, 549978112, 545783808, 545783808, 545783808, 545783808, 545783808, 545783808, 553123840, 545783808, 552075264, 553123840, 549978112, 552075264, 549978112, 549978112, 545783808, 549978112, 545783808, 545783808, 545783808, 545783808, 545783808, 545783808, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 1007715361, 1007681536, 68191232, 68157440, 470844448, 470810624, 1007715328, 1007681536, 68191265, 68157440, 470844416, 470810624, 68191264, 68157440, 68191232, 68157440, 202408993, 202375168, 68191232, 68157440, 202407936, 202375168, 202408960, 202375168, 68190208, 68157440, 202407936, 202375168, 68190208, 68157440, 68190208, 68157440, 470843392, 470810624, 68190208, 68157440, 1007715360, 1007681536, 470843392, 470810624, 68190208, 68157440, 1007715328, 1007681536, 68191264, 68157440, 68190208, 68157440, 202408993, 202375168, 68191232, 68157440, 202408992, 202375168, 202408960, 202375168, 68191265, 68157440, 202408960, 202375168, 68190208, 68157440, 68191232, 68157440, 1007714304, 1007681536, 68190208, 68157440, 470843392, 470810624, 1007714304, 1007681536, 68190208, 68157440, 470843392, 470810624, 68190208, 68157440, 68190208, 68157440, 202407936, 202375168, 68190208, 68157440, 202408992, 202375168, 202407936, 202375168, 68191265, 68157440, 202408960, 202375168, 68191264, 68157440, 68191232, 68157440, 470844449, 470810624, 68191232, 68157440, 1007714304, 1007681536, 470844416, 470810624, 68191265, 68157440, 1007714304, 1007681536, 68190208, 68157440, 68191232, 68157440, 202407936, 202375168, 68190208, 68157440, 202407936, 202375168, 202407936, 202375168, 68190208, 68157440, 202407936, 202375168, 68191264, 68157440, 68190208, 68157440 }, { 975243330, 169869312, 975243264, 975241216, 975243328, 975241216, 975243264, 975241216, 169936962, 975241216, 169936896, 169934848, 169936960, 169934848, 169936896, 169934848, 438372418, 169934848, 438372352, 438370304, 438372416, 438370304, 438372352, 438370304, 169936962, 438370304, 169936896, 169934848, 169936960, 169934848, 169936896, 169934848, 975175680, 169934848, 975175680, 975175680, 975175680, 975175680, 975175680, 975175680, 169869312, 975175680, 169869312, 169869312, 169869312, 169869312, 169869312, 169869312, 438304768, 169869312, 438304768, 438304768, 438304768, 438304768, 438304768, 438304768, 169869312, 438304768, 169869312, 169869312, 169869312, 169869312, 169869312, 169869312, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 910299268, 910299136, 910163968, 910163968, 876744832, 876744704, 876609536, 876609536, 910295040, 910295040, 910163968, 910163968, 876740608, 876740608, 876609536, 876609536, 373428356, 373428224, 373293056, 373293056, 339873920, 339873792, 339738624, 339738624, 373424128, 373424128, 373293056, 373293056, 339869696, 339869696, 339738624, 339738624, 910299264, 910299136, 910163968, 910163968, 876744836, 876744704, 876609536, 876609536, 910295040, 910295040, 910163968, 910163968, 876740608, 876740608, 876609536, 876609536, 373428352, 373428224, 373293056, 373293056, 339873924, 339873792, 339738624, 339738624, 373424128, 373424128, 373293056, 373293056, 339869696, 339869696, 339738624, 339738624, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 780411144, 780140544, 679747584, 679477248, 780402688, 780140544, 679739392, 679477248, 746856712, 746586112, 679747584, 679477248, 746848256, 746586112, 679739392, 679477248, 679747848, 679477248, 780410880, 780140544, 679739392, 679477248, 780402688, 780140544, 679747848, 679477248, 746856448, 746586112, 679739392, 679477248, 746848256, 746586112, 780411136, 780140544, 679747584, 679477248, 780402688, 780140544, 679739392, 679477248, 746856704, 746586112, 679747584, 679477248, 746848256, 746586112, 679739392, 679477248, 679747840, 679477248, 780410880, 780140544, 679739392, 679477248, 780402688, 780140544, 679747840, 679477248, 746856448, 746586112, 679739392, 679477248, 746848256, 746586112, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }, { 520634896, 285753344, 487063552, 285736960, 419430400, 285212672, 285212672, 520093696, 285736960, 419954688, 520634880, 285753344, 486539264, 285212672, 419430400, 285212672, 285753872, 487079936, 285736960, 419954688, 520093696, 285212672, 486539264, 285212672, 419954688, 285736960, 285753856, 487079936, 285212672, 419430400, 520093696, 285212672, 419971600, 285753344, 419954688, 285736960, 285212672, 486539264, 285212672, 419430400, 520617984, 285736960, 419971584, 285753344, 419430400, 285212672, 285212672, 486539264, 285753872, 419971072, 520617984, 285736960, 419430400, 285212672, 419430400, 285212672, 285736960, 487063552, 285753856, 419971072, 520093696, 285212672, 419430400, 285212672, 285753872, 520634368, 285736960, 487063552, 285212672, 419430400, 520093696, 285212672, 419954688, 285736960, 285753856, 520634368, 285212672, 486539264, 285212672, 419430400, 487080464, 285753344, 419954688, 285736960, 285212672, 520093696, 285212672, 486539264, 285736960, 419954688, 487080448, 285753344, 419430400, 285212672, 285212672, 520093696, 285753872, 419971072, 285736960, 419954688, 486539264, 285212672, 419430400, 285212672, 285736960, 520617984, 285753856, 419971072, 285212672, 419430400, 486539264, 285212672, 419971600, 285753344, 285736960, 520617984, 285212672, 419430400, 285212672, 419430400, 487063552, 285736960, 419971584, 285753344, 285212672, 520093696, 285212672, 419430400 } };

const int BishopBits[30] = { 3, 2, 2, 2, 3,
                       3, 2, 2, 2, 3,
                       3, 3, 4, 3, 3,
                       3, 3, 4, 3, 3,
                       3, 2, 2, 2, 3,
                       3, 2, 2, 2, 3 };

const int RookBits[30] = { 7, 6, 6, 6, 7,
                     6, 5, 5, 5, 6,
                     6, 5, 5, 5, 6,
                     6, 5, 5, 5, 6,
                     6, 5, 5, 5, 6,
                     7, 6, 6, 6, 7 };

typedef std::pair<size_t, size_t> Point;
typedef std::pair<Point, Point> Move;

enum GameState {
  UNKNOWN = 0,
  WIN,
  DRAW,
  NONE
};


class State{
  public:
    //You may want to add more property for a state
    GameState game_state = (GameState) UNKNOWN;
    int board[12];
    Player player = WHITE;
    std::vector<Move> legal_actions;

    int playerBoard, opponentBoard;
    void checkWin();

    int getBoardbyPiece(Piece pieceType);
    int getOpponentBoardbyPiece(Piece pieceType);

    State();
    State(Player player);
    State(int* board);
    State(int* board, Player player);

    Player opponent();
    int getPlayerBoard();
    int getOpponentBoard();
    static int transform(int board, int magic, int offset);
    
    float evaluate(Player side);
    State* next_state(Move move);
    void get_legal_actions();
    char* encode_state();
};

int pawnAttack(int board, Player player);
int pawnMove(int board, Player player);

int knightAttack(int board);

int kingAttack(int board);

int bishopAttack(int square, int selfBoard, int oppoBoard);

int rookAttack(int square, int selfBoard, int oppoBoard);

int eastOne(int board);
int westOne(int board);
int northOne(int board);
int southOne(int board);

int isPowerofTwo(int num);
std::vector<Point> binaryBitScan(int segment, int size, int offset);
std::vector<Point> bitScan(int board);
Point indexToPoint(int index);
int pointToIndex(Point point);
int countOnes(int board);

#endif